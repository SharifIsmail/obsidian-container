services:
  obsidian:
    image: lscr.io/linuxserver/obsidian:latest
    container_name: obsidian
    env_file: .env
    volumes:
      - ${CONFIG_PATH:-./config}:/config
      - ./custom-cont-init.d:/custom-cont-init.d:ro
    ports:
      - "127.0.0.1:3000:3000"
      - "127.0.0.1:3001:3001"
      - "127.0.0.1:9999:9999"
    shm_size: "1g"
    restart: unless-stopped

  rclone-backup:
    image: rclone/rclone
    container_name: rclone-backup
    entrypoint: /bin/sh
    command: -c "while true; do sleep 900; rclone sync /data gdrive:notes --log-level NOTICE; done"
    volumes:
      - ${CONFIG_PATH:-./config}/notes:/data:ro
      - ${RCLONE_CONFIG:-./rclone}:/config/rclone
    environment:
      - XDG_CONFIG_HOME=/config
    restart: unless-stopped
